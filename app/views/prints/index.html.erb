<% if @customer %>
  <h2>
    <%= t('view.prints.prints_with_customer', customer: @customer.to_s) %>
  </h2>
<% end %>
<table class="table table-striped">
  <thead>
    <tr>
      <th><%= Print.human_attribute_name 'id' %></th>
      <th><%= Print.human_attribute_name 'created_at' %></th>
      <th class="visible-desktop"><%= Document.human_attribute_name 'code', count: 0 %></th>
      <th class="visible-desktop"><%= Print.human_attribute_name 'customer' %></th>
      <th class="visible-desktop"><%= Print.human_attribute_name 'scheduled_at' %></th>
      <th class="visible-desktop"><%= Print.human_attribute_name 'user' %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @prints.each do |print| %>
      <tr class="<%= print.revoked ? 'revoked ' : '' %>">
        <td><%= print.id %></td>
        <td><%= l print.created_at, format: :short if print.created_at %></td>
        <td class="visible-desktop"><%= display_print_jobs_codes(print) %></td>
        <td class="visible-desktop"><%= print.customer || '-' %></td>
        <td class="visible-desktop"><%= l print.scheduled_at, format: :short if print.scheduled_at %></td>
        <td class="visible-desktop"><%= print.user %></td>
        <td><%= link_to_show print %></td>
        <td><%= link_to_edit edit_print_path(print, status: params[:status]) if print.pending_payment? || print.scheduled? %></td>
        <td>
          <%= link_to(
            '&#x26d4;'.html_safe, revoke_print_path(print),
            method: :delete, title: t('view.prints.revoke'), class: 'iconic',
            data: {
              'show-tooltip' => true,
              'confirm' => t('messages.confirmation')
            }
          ) if current_user.admin? && !print.revoked %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= pagination_links(@prints) %>

<nav class="form-actions">
  <div class="btn-group">
    <%= link_to t('view.prints.new'), new_print_path, class: 'btn btn-primary' %>
    <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
      <% if @customer.nil? && params[:status] != 'scheduled' %>
        <li>
          <%= link_to(
            textilize_without_paragraph(t('view.prints.show_scheduled.html')),
            prints_path(status: 'scheduled')
          ) %>
        </li>
      <% end %>
      <% if @customer.nil? && params[:status] != 'pending' %>
        <li>
          <%= link_to(
            textilize_without_paragraph(t('view.prints.show_pending.html')),
            prints_path(status: 'pending')
          ) %>
        </li>
      <% end %>
      <% if params[:status] != 'all' %>
        <li>
          <%= link_to(
            textilize_without_paragraph(t('view.prints.show_all.html')),
            prints_path(status: 'all')
          ) %>
        </li>
      <% end %>
    </ul>
  </div>
</nav>