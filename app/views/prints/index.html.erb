<% if @customer %>
  <h2>
    <%= t('view.prints.prints_with_customer', customer: @customer.to_s) %>
  </h2>
<% end %>
<table class="table">
  <thead>
    <tr>
      <th><%= Print.human_attribute_name 'id' %></th>
      <th><%= Print.human_attribute_name 'created_at' %></th>
      <th><%= Document.human_attribute_name 'code', count: 0 %></th>
      <th><%= Print.human_attribute_name 'customer' %></th>
      <th><%= Print.human_attribute_name 'scheduled_at' %></th>
      <th><%= Print.human_attribute_name 'user' %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @prints.each do |print| %>
      <tr class="<%= print.revoked ? 'revoked ' : '' %>">
        <td><%= print.id %></td>
        <td><%= l print.created_at, format: :short if print.created_at %></td>
        <td><%= display_print_jobs_codes(print) %></td>
        <td><%= print.customer || '-' %></td>
        <td><%= l print.scheduled_at, format: :short if print.scheduled_at %></td>
        <td><%= print.user %></td>
        <td><%= link_to_show print %></td>
        <td><%= link_to_edit edit_print_path(print, status: params[:status]) if print.pending_payment? || print.scheduled? %></td>
        <td>
          <%= link_to(
            '&#x26d4;'.html_safe, revoke_print_path(print),
            method: :delete, confirm: t('messages.confirmation'),
            title: t('view.prints.revoke'), class: 'iconic',
            data: {'show-tooltip' => true}
          ) if current_user.admin? && !print.revoked %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<nav class="form-actions">
  <%= pagination_links(@prints) %>
  <%= link_to t('view.prints.new'), new_print_path, class: 'btn btn-primary' %>
  <% if @customer.nil? && params[:status] != 'scheduled' %>
    | <%= link_to(
        textilize_without_paragraph(t('view.prints.show_scheduled')),
        prints_path(status: 'scheduled')
      ) %>
  <% end %>
  <% if @customer.nil? && params[:status] != 'pending' %>
    | <%= link_to(
        textilize_without_paragraph(t('view.prints.show_pending')),
        prints_path(status: 'pending')
      ) %>
  <% end %>
  <% if params[:status] != 'all' %>
    | <%= link_to(
        textilize_without_paragraph(t('view.prints.show_all')),
        prints_path(status: 'all')
      ) %>
  <% end %>
</nav>