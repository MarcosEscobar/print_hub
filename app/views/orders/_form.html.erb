<%= form_for(@order) do |f| %>
  <%= show_error_messages(@order) %>

  <div class="field">
    <%= f.label :scheduled_at %>
    <%= calendar_text_field f, :scheduled_at, true %>
  </div>
  
  <section class="nested_items">
    <h2><%= t :order_lines, :scope => [:view, :orders] %></h2>
    
    <div id="order_lines_headers" class="headers">
      <h3><%= OrderLine.human_attribute_name :document_id %></h3>
      <h3><%= OrderLine.human_attribute_name :copies %></h3>
      <h3><%= Document.human_attribute_name :pages %></h3>
      <h3><%= OrderLine.human_attribute_name :price_per_copy %></h3>
      <h3><%= OrderLine.human_attribute_name :range %></h3>
      <h3><%= OrderLine.human_attribute_name :two_sided %></h3>
      <br class="break" />
    </div>
    
    <div id="order_lines" class="items">
      <%= f.fields_for :order_lines do |ol_f| %>
        <%= render :partial => 'order_line', :locals => {
          :f => ol_f, :disabled => !@order.new_record?
        } %>
      <% end %>
    </div>
  </section>

  <%= render :partial => 'total', :locals => { :order => @order } %>
  
  <div class="actions">
    <%= f.hidden_field :lock_version %>
    <%= f.submit %>
  </div>
<% end %>
<script type="text/javascript">
jQuery(function() {
  $('a.details_link').live('ajax:success', function(event, data) {
    Helper.show($(this).parents('.order_line').find('.dynamic_details').hide().html(data));
  });
});
</script>